{"id":"nJw+","dependencies":[{"name":"/Users/hansoksendahl/Code/hox.io/packages/@hox.io/app/package.json","includedInParent":true,"mtime":1561481613478},{"name":"dexie","loc":{"line":1,"column":18},"parent":"/Users/hansoksendahl/Code/hox.io/packages/@hox.io/app/node_modules/@hox.io/use-dexie/src/index.js","resolved":"/Users/hansoksendahl/Code/hox.io/packages/@hox.io/app/node_modules/@hox.io/use-dexie/node_modules/dexie/dist/dexie.es.js"},{"name":"react","loc":{"line":2,"column":34},"parent":"/Users/hansoksendahl/Code/hox.io/packages/@hox.io/app/node_modules/@hox.io/use-dexie/src/index.js","resolved":"/Users/hansoksendahl/Code/hox.io/packages/@hox.io/app/node_modules/react/index.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.version=u,exports.default=n;var e=t(require(\"dexie\")),r=require(\"react\");function t(e){return e&&e.__esModule?e:{default:e}}function u(e,r,t=null){return{versionNumber:e,stores:r,upgrade:t}}function n(t,u,n=null,o=null){const[s,l]=(0,r.useState)(null);return(0,r.useEffect)(()=>{const r=new e.default(t);for(const e of u){const{versionNumber:t,stores:u,upgrade:n}=e,o=r.version(t);o.stores(u),n&&o.upgrade(n)}return n&&r.on(\"populate\",n),r.on(\"ready\",e=>{l(r),o&&o(r)}),r.open(),()=>{r.close()}},[t,u]),s}"},"sourceMaps":{"js":{"mappings":[{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":80,"column":1},"generated":{"line":1,"column":0}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":80,"column":1},"generated":{"line":1,"column":13}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":80,"column":1},"generated":{"line":1,"column":20}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":80,"column":1},"generated":{"line":1,"column":35}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":80,"column":1},"generated":{"line":1,"column":43}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":80,"column":1},"generated":{"line":1,"column":56}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":80,"column":1},"generated":{"line":1,"column":57}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":80,"column":1},"generated":{"line":1,"column":64}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":80,"column":1},"generated":{"line":1,"column":68}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":80,"column":1},"generated":{"line":1,"column":76}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":80,"column":1},"generated":{"line":1,"column":84}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":80,"column":1},"generated":{"line":1,"column":86}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":80,"column":1},"generated":{"line":1,"column":94}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":80,"column":1},"generated":{"line":1,"column":102}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":1,"column":0},"generated":{"line":1,"column":104}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":1,"column":0},"generated":{"line":1,"column":108}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":1,"column":0},"generated":{"line":1,"column":110}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":1,"column":0},"generated":{"line":1,"column":112}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":1,"column":0},"generated":{"line":1,"column":120}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":2,"column":0},"generated":{"line":1,"column":130}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":2,"column":0},"generated":{"line":1,"column":132}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":2,"column":0},"generated":{"line":1,"column":140}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":80,"column":1},"generated":{"line":1,"column":149}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":80,"column":1},"generated":{"line":1,"column":158}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":80,"column":1},"generated":{"line":1,"column":160}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":80,"column":1},"generated":{"line":1,"column":163}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":80,"column":1},"generated":{"line":1,"column":170}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":80,"column":1},"generated":{"line":1,"column":173}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":80,"column":1},"generated":{"line":1,"column":175}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":80,"column":1},"generated":{"line":1,"column":186}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":80,"column":1},"generated":{"line":1,"column":188}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":80,"column":1},"generated":{"line":1,"column":189}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":80,"column":1},"generated":{"line":1,"column":197}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":20,"column":7},"generated":{"line":1,"column":200}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"version","original":{"line":20,"column":16},"generated":{"line":1,"column":209}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"versionNumber","original":{"line":21,"column":2},"generated":{"line":1,"column":211}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"stores","original":{"line":22,"column":2},"generated":{"line":1,"column":213}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"upgrade","original":{"line":23,"column":2},"generated":{"line":1,"column":215}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":23,"column":12},"generated":{"line":1,"column":217}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":25,"column":9},"generated":{"line":1,"column":223}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":25,"column":9},"generated":{"line":1,"column":229}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"versionNumber","original":{"line":26,"column":4},"generated":{"line":1,"column":230}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"versionNumber","original":{"line":26,"column":4},"generated":{"line":1,"column":244}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"stores","original":{"line":27,"column":4},"generated":{"line":1,"column":246}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"stores","original":{"line":27,"column":4},"generated":{"line":1,"column":253}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"upgrade","original":{"line":28,"column":4},"generated":{"line":1,"column":255}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"upgrade","original":{"line":28,"column":4},"generated":{"line":1,"column":263}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":40,"column":15},"generated":{"line":1,"column":266}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"useDexie","original":{"line":40,"column":24},"generated":{"line":1,"column":275}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"dbName","original":{"line":41,"column":2},"generated":{"line":1,"column":277}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"versions","original":{"line":42,"column":2},"generated":{"line":1,"column":279}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"populate","original":{"line":43,"column":2},"generated":{"line":1,"column":281}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":43,"column":13},"generated":{"line":1,"column":283}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"ready","original":{"line":44,"column":2},"generated":{"line":1,"column":288}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":44,"column":10},"generated":{"line":1,"column":290}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":46,"column":8},"generated":{"line":1,"column":296}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"db","original":{"line":46,"column":9},"generated":{"line":1,"column":302}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"setDb","original":{"line":46,"column":13},"generated":{"line":1,"column":304}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":46,"column":22},"generated":{"line":1,"column":308}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":46,"column":31},"generated":{"line":1,"column":310}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":46,"column":31},"generated":{"line":1,"column":312}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":46,"column":31},"generated":{"line":1,"column":322}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"db","original":{"line":79,"column":9},"generated":{"line":1,"column":328}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":49,"column":4},"generated":{"line":1,"column":335}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":49,"column":4},"generated":{"line":1,"column":337}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":49,"column":4},"generated":{"line":1,"column":339}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":49,"column":4},"generated":{"line":1,"column":350}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"connection","original":{"line":50,"column":12},"generated":{"line":1,"column":355}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"connection","original":{"line":50,"column":12},"generated":{"line":1,"column":361}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":50,"column":25},"generated":{"line":1,"column":363}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"Dexie","original":{"line":50,"column":29},"generated":{"line":1,"column":367}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":50,"column":25},"generated":{"line":1,"column":369}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"dbName","original":{"line":50,"column":35},"generated":{"line":1,"column":377}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":52,"column":11},"generated":{"line":1,"column":380}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":52,"column":11},"generated":{"line":1,"column":384}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"versionDescription","original":{"line":52,"column":17},"generated":{"line":1,"column":390}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"versions","original":{"line":52,"column":39},"generated":{"line":1,"column":395}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":52,"column":49},"generated":{"line":1,"column":397}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":53,"column":14},"generated":{"line":1,"column":398}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":53,"column":14},"generated":{"line":1,"column":404}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"versionNumber","original":{"line":53,"column":15},"generated":{"line":1,"column":418}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":53,"column":14},"generated":{"line":1,"column":420}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"stores","original":{"line":53,"column":30},"generated":{"line":1,"column":427}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":53,"column":14},"generated":{"line":1,"column":429}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"upgrade","original":{"line":53,"column":38},"generated":{"line":1,"column":437}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"versionDescription","original":{"line":53,"column":49},"generated":{"line":1,"column":440}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"version","original":{"line":54,"column":14},"generated":{"line":1,"column":442}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"connection","original":{"line":54,"column":24},"generated":{"line":1,"column":444}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"version","original":{"line":54,"column":35},"generated":{"line":1,"column":446}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"versionNumber","original":{"line":54,"column":43},"generated":{"line":1,"column":454}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"version","original":{"line":55,"column":8},"generated":{"line":1,"column":457}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"stores","original":{"line":55,"column":16},"generated":{"line":1,"column":459}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"stores","original":{"line":55,"column":23},"generated":{"line":1,"column":466}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"upgrade","original":{"line":57,"column":12},"generated":{"line":1,"column":469}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"version","original":{"line":57,"column":21},"generated":{"line":1,"column":472}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"upgrade","original":{"line":57,"column":29},"generated":{"line":1,"column":474}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"upgrade","original":{"line":57,"column":37},"generated":{"line":1,"column":482}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":72,"column":13},"generated":{"line":1,"column":485}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"populate","original":{"line":60,"column":10},"generated":{"line":1,"column":492}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"connection","original":{"line":61,"column":8},"generated":{"line":1,"column":495}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"on","original":{"line":61,"column":19},"generated":{"line":1,"column":497}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":61,"column":22},"generated":{"line":1,"column":500}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"populate","original":{"line":61,"column":34},"generated":{"line":1,"column":511}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"connection","original":{"line":64,"column":6},"generated":{"line":1,"column":514}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"on","original":{"line":64,"column":17},"generated":{"line":1,"column":516}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":64,"column":20},"generated":{"line":1,"column":519}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"tx","original":{"line":64,"column":29},"generated":{"line":1,"column":527}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"setDb","original":{"line":65,"column":8},"generated":{"line":1,"column":531}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"connection","original":{"line":65,"column":14},"generated":{"line":1,"column":533}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"ready","original":{"line":67,"column":12},"generated":{"line":1,"column":536}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"ready","original":{"line":67,"column":19},"generated":{"line":1,"column":539}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"connection","original":{"line":67,"column":25},"generated":{"line":1,"column":541}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"connection","original":{"line":70,"column":6},"generated":{"line":1,"column":546}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"open","original":{"line":70,"column":17},"generated":{"line":1,"column":548}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":72,"column":13},"generated":{"line":1,"column":555}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"connection","original":{"line":73,"column":8},"generated":{"line":1,"column":560}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"close","original":{"line":73,"column":19},"generated":{"line":1,"column":562}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","original":{"line":76,"column":4},"generated":{"line":1,"column":572}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"dbName","original":{"line":76,"column":5},"generated":{"line":1,"column":573}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"versions","original":{"line":76,"column":13},"generated":{"line":1,"column":575}},{"source":"node_modules/@hox.io/use-dexie/src/index.js","name":"db","original":{"line":79,"column":9},"generated":{"line":1,"column":579}}],"sources":{"node_modules/@hox.io/use-dexie/src/index.js":"import Dexie from 'dexie';\nimport {useState, useEffect} from 'react';\n\n/**\n * @typedef {Object} Version\n * @property {number} versionNumber The version number of the database\n * @property {Object} stores A Dexie store description object\n * @property {Function} upgrade An upgrade function for this version.\n */\n\n\n /**\n  * A function which will return a useDexie version object.\n  * \n  * @param {number} versionNumber\n  * @param {Object} stores\n  * @param {Function} upgrade\n  * @return {Version}\n  */\nexport function version(\n  versionNumber,\n  stores,\n  upgrade = null,\n) {\n  return {\n    versionNumber,\n    stores,\n    upgrade,\n  }\n}\n\n/**\n * \n * @param {string} dbName The database name\n * @param {Version[]} versions An array of database Version objects\n * @param {Function} populate A function to populate the database\n * @param {Function} ready A function to run when the database is ready\n * @return Dexie\n */\nexport default function useDexie(\n  dbName,\n  versions,\n  populate = null,\n  ready = null,\n) {\n  const [db, setDb] = useState(null);\n\n  useEffect(\n    () => {\n      const connection = new Dexie(dbName);\n\n      for (const versionDescription of versions) {\n        const {versionNumber, stores, upgrade} = versionDescription;\n        const version = connection.version(versionNumber)\n        version.stores(stores);\n        \n        if (upgrade) version.upgrade(upgrade);\n      }\n\n      if (populate) {\n        connection.on('populate', populate);\n      }\n\n      connection.on('ready', tx => {\n        setDb(connection);\n\n        if (ready) ready(connection);\n      });\n\n      connection.open();\n\n      return () => {\n        connection.close();\n      }\n    },\n    [dbName, versions],\n  );\n\n  return db;\n}"},"lineCount":null}},"error":null,"hash":"8101d54eb0dd69c5d3e104df7a5e2cd5","cacheData":{"env":{}}}