# Set up Bun
FROM node:latest as dependencies
WORKDIR /app
RUN corepack enable
RUN curl -fsSL https://bun.sh/install | bash
COPY . . 

# Install app dependencies
RUN pnpm install

# Build production image
FROM dependencies as builder

# Build app
WORKDIR /app/packages/@hox.io/blog
RUN bun run build

# Run the server
EXPOSE 8080
CMD ["bun", "run", "start"]